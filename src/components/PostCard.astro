---
import type { CollectionEntry } from 'astro:content';
import SectionTag from './SectionTag.astro';

interface Props {
  post: CollectionEntry<'posts'> & { readingTimeMinutes?: number };
  publication?: CollectionEntry<'publications'>;
  showSummary?: boolean;
}

const { post, publication, showSummary = true } = Astro.props;
---
<a
  href={`/posts/${post.slug}`}
  class="group block rounded-lg border border-[var(--rule)] bg-[var(--paper)] p-4 shadow-paper transition-transform hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-[var(--accent)]"
  style={publication ? `--accent:${publication.data.accent}` : undefined}
>
  <div class="mb-3 flex items-center justify-between">
    <SectionTag label={post.data.format.toUpperCase()} />
    <span class="text-[11px] uppercase tracking-[0.18em] text-[var(--accent)]">{post.data.sectionId}</span>
  </div>
  <h3 class={`font-display text-xl leading-tight ${publication?.data.displayFont ?? ''}`}>{post.data.headline}</h3>
  {showSummary && <p class="mt-2 text-sm text-neutral-200">{post.data.summary}</p>}
  <div class="mt-3 flex items-center gap-4 text-xs uppercase tracking-[0.14em] text-neutral-300">
    <span>{new Date(post.data.publishedAt).toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' })}</span>
    {post.readingTimeMinutes && <span>{post.readingTimeMinutes} min read</span>}
  </div>
</a>
