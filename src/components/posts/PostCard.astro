---
import type { CollectionEntry } from 'astro:content';
import type { PostRecord } from '../../lib/contentTypes';
import SectionTag from '../ui/SectionTag.astro';

type PostCardPost = PostRecord | (CollectionEntry<'posts'> & { readingTimeMinutes?: number });

interface Props {
  post: PostCardPost;
  publication?: CollectionEntry<'publications'>;
  showSummary?: boolean;
}

const { post, publication, showSummary = true } = Astro.props;
const accentColor = publication?.data.accent ?? 'var(--pop-coral)';
---
<a
  href={`/posts/${post.slug}`}
  class="post-card"
  style={`--card-accent: ${accentColor}`}
>
  <div class="post-card__header">
    <SectionTag label={post.data.format.toUpperCase()} />
    <span class="post-card__section">
      {post.data.sectionId}
    </span>
  </div>
  <h3 class="post-card__title">{post.data.headline}</h3>
  {showSummary && <p class="post-card__summary">{post.data.summary}</p>}
  <div class="post-card__meta">
    <span>{new Date(post.data.publishedAt).toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' })}</span>
    {post.readingTimeMinutes && <span>{post.readingTimeMinutes} min read</span>}
  </div>
</a>
